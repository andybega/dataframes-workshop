---
title: "Python dataframes with pandas and polars"
author: "Andreas Beger and Isaac Chung <br/> PyData Tallinn x Python CodeClub <br/> 27 November 2024"
format: 
    revealjs:
        theme: [default, styles.scss]
        embed-resources: true
---

## Bios

:::: {.columns}

::: {.column width="47%"}
**Andreas Beger**

- ğŸ¢ Data Scientist, Consult.
- ğŸƒâ€â™‚ï¸ğŸŒ Slow marathoner
- ğŸ“ ğŸ‡©ğŸ‡ª/ğŸ‡­ğŸ‡· â†’ ğŸ‡ºğŸ‡¸ â†’ ğŸ‡ªğŸ‡ª
- ğŸ“ PhD Political Science

:::

::: {.column width="53%"}
**Isaac Chung**

- ğŸ¢ Staff Data Scientist, Wrike
- ğŸŠâ€â™‚ï¸ğŸš´ğŸƒâ€â™‚ï¸ Fast triathlete
- ğŸ“ ğŸ‡­ğŸ‡° â†’ ğŸ‡¨ğŸ‡¦ â†’ ğŸ‡ªğŸ‡ª
- ğŸ“ MS Machine Learning

:::

****

ğŸ We are also the PyData Tallinn co-organizers.

::::

## Link to notebooks

![](media/dataframes-repo-qr-code.png)

## Getting setup

Instructions for how to follow along in notebooks...GitHub codespaces?

# What are dataframes?

## Definition

Tables, 2d arrays, etc. 

## Why?

Show a list of python dictionaries 

vs

pandas data frame

## Common dataframe operations

:::: {.columns .v-center-container}

::: {.column width="50%"}

- ğŸ“– âœï¸ read and write
- ğŸ”¬ inspect
- ğŸ” filter rows
- ğŸ›’ select columns

:::

::: {.column width="50%"}

- ğŸ¥ª mutate, add columns
- ğŸ¤ join other dataframes
- ğŸ‘¨â€ğŸ‘©â€ğŸ‘§â€ğŸ‘¦ group and aggregate
- ğŸ§± reshape wide, long

:::

::::

# pandas

![](media/pandas-logo.png)

## History

Wes McKinney

originally built on top of numpy
pandas 2 () adds support for arrow backend

## Getting started {.smaller}

```{python}
#| echo: true
import numpy as np
import pandas as pd

df = pd.DataFrame({
    "quarter": [1, 1, 1, 2, 2, 2, 3, 3, 3, 4, 4, 4],
    "x": np.random.randn(12),
    "date": pd.date_range("2024-01-01", periods=12, freq="MS")
})

df.head()

```

## Import accidents data


## pandas is great


. . .

<br/>
2017, Wes McKinney (creator of pandas):

. . . 

> **10 Things I Hate About Pandas **

. . . 

- Inefficient memory management, need 5-10x data size
- Eager evaluation â†’ limited query planning
- No multi-core


::: aside
[https://wesmckinney.com/blog/apache-arrow-pandas-internals/](https://wesmckinney.com/blog/apache-arrow-pandas-internals/)
:::

## Arrow

2016 Apache Arrow as common in-memory data representation standard

# polars

![](media/polars-logo.jpg)



## History

2020 Ritchie Vink

Uses arrow as internal representation

## new slides

- Out with indices
- Out with `.loc`, `.iloc`
- Out with `[`
- In with lazy evaluation
- Expressions

## Easy to convert between the two

```python
df = df.to_pandas()
df = pl.from_pandas(df)
```

## example

go through same example again, but with polars

# The big picture

## Andy is a polars stan {.smaller}


![](media/star-history.png){width=60% fig-align="center"}

::: aside
https://star-history.com/#apache/spark&pola-rs/polars&pandas-dev/pandas&narwhals-dev/narwhals&duckdb/duckdb&Date 
:::

## Comparison

:::: {.columns}

::: {.column width="50%"}

**pandas**

- âœ… Very widely used and supported
- âœ… Stable
- â“ More imperative, traditional API
- âŒ Inconsistent API, multiple ways of doing the same thing

:::

::: {.column width="50%"}

**polars**

- âœ… More consistent, functional-style API
- âœ… Faster, less memory footprint
- âœ… Works with OOM datasets out of the box
- âŒ API still changing

:::

::::


## Other frameworks

- Narwhal
- DuckDB

## Thank you!

Scan this and let us know how we did ğŸ¤—

![](media/pydata-meetup-feedback-logo.png)